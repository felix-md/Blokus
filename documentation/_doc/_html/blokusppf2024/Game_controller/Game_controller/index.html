<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Game_controller (blokusppf2024.Game_controller.Game_controller)</title><link rel="stylesheet" href="../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">blokusppf2024</a> &#x00BB; <a href="../index.html">Game_controller</a> &#x00BB; Game_controller</nav><header class="odoc-preamble"><h1>Module <code><span>Game_controller.Game_controller</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-set_non_canonical_mode"><a href="#val-set_non_canonical_mode" class="anchor"></a><code><span><span class="keyword">val</span> set_non_canonical_mode : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Sets the terminal to non-canonical mode.</p><p>This function modifies the terminal settings to disable canonical mode, which allows input to be read character-by-character without waiting for a newline. It also sets the minimum number of characters for non-canonical read to 1 and the timeout to 0.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Unix.Unix_error</span> <p>if there is an error in getting or setting the terminal attributes.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-restore_canonical_mode"><a href="#val-restore_canonical_mode" class="anchor"></a><code><span><span class="keyword">val</span> restore_canonical_mode : <span><span class="xref-unresolved">Unix</span>.terminal_io <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>restore_canonical_mode termio</code> restores the terminal to its canonical mode using the provided terminal attributes <code>termio</code>. This function uses <code>tcsetattr</code> to set the terminal attributes immediately (TCSANOW) for the standard input (stdin).</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">termio</span> <p>The terminal attributes to be restored.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_single_char"><a href="#val-read_single_char" class="anchor"></a><code><span><span class="keyword">val</span> read_single_char : <span>unit <span class="arrow">&#45;&gt;</span></span> char</span></code></div><div class="spec-doc"><p><code>read_single_char ()</code> reads a single character from the standard input. It creates a buffer of size 1, reads one byte from the standard input into the buffer, and returns the character at the first position of the buffer.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>the character read from the standard input.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clear_screen"><a href="#val-clear_screen" class="anchor"></a><code><span><span class="keyword">val</span> clear_screen : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>clear_screen ()</code> clears the terminal screen by printing the appropriate escape sequences to move the cursor to the home position and clear the screen. It then flushes the standard output to ensure the changes are displayed immediately.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_piece_selection_input"><a href="#val-handle_piece_selection_input" class="anchor"></a><code><span><span class="keyword">val</span> handle_piece_selection_input : 
  <span><a href="../../Player/Player/index.html#type-t">Player.Player.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>[&gt; `Continue <span>| `Pass</span> <span>| `PieceSelected</span> ]</span></span></code></div><div class="spec-doc"><p>Handles the input for piece selection during the game.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">current_player</span> <p>The player whose input is being handled.</p><p>The function reads a single character input from the user and performs actions based on the input:</p><ul><li>If the input is the escape character ('\027'), it reads additional characters to determine if an arrow key was pressed:</li><li>'C' (right arrow) increments the player's piece selection index.</li><li>'D' (left arrow) decrements the player's piece selection index.</li><li>If the input is a space character (' '), it selects the piece at the current index, removes it from the player's available pieces, and resets the selection index.</li><li>If the input is 'p', it indicates that the player wants to pass their turn.</li><li>If the input is 'q', it raises an exception to exit the input loop.</li><li>For any other input, it continues without making changes.</li></ul></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>A variant indicating the result of the input handling:</p><ul><li>`Continue` if the input handling should continue.</li><li>`PieceSelected` if a piece was selected.</li><li>`Pass` if the player chose to pass their turn.</li><li>Raises `ExitLoop` if the player chose to quit.</li></ul></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_game_input"><a href="#val-handle_game_input" class="anchor"></a><code><span><span class="keyword">val</span> handle_game_input : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Game/Game/index.html#type-play">Game.Game.play</a> option</span></span></code></div><div class="spec-doc"><p>Handles the game input from the user. This function reads a single character from the user input and matches it to perform corresponding game actions.</p><ul><li>If the input is an escape character ('\027'), it reads the next character to check for arrow keys:</li><li>'C' -&gt; Moves the game piece right.</li><li>'D' -&gt; Moves the game piece left.</li><li>'B' -&gt; Moves the game piece down.</li><li>'A' -&gt; Moves the game piece up.</li><li>'f' -&gt; Flips the game piece.</li><li>'r' -&gt; Rotates the game piece.</li><li>' ' (space) -&gt; Places the game piece.</li><li>'c' -&gt; Cancels the current action.</li><li>'p' -&gt; Passes the turn.</li><li>'q' -&gt; Exits the game loop by raising an ExitLoop exception.</li><li>Any other input returns None.</li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>An option type with the corresponding game action or None if the input is not recognized.</p></li></ul></div></div></div></body></html>